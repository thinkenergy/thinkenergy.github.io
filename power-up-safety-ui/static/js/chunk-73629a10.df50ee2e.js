/*!
 *  build: vue-admin-beautiful 
 *  copyright: chuzhixin 1204505056@qq.com 
 *  time: 2021-8-30 16:21:51
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73629a10"],{"23df":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAMAAAAMCGV4AAAAkFBMVEVHcEyVlZX///+VlZWVlZWVlZWWlpaWlpaWlpaVlZWXl5eVlZWNjY2VlZWWlpaWlpaWlpaVlZWWlpafn5+WlpaWlpaWlpaWlpaWlpaWlpaWlpaXl5eWlpaVlZWVlZWWlpaTk5OVlZWWlpaVlZWVlZWXl5eWlpaVlZWVlZWVlZWUlJSVlZWVlZWVlZWWlpaWlpaNFUptAAAAL3RSTlMA/gGnQbYzqr46SsYJUs2BSaV1CP2e+yfWaZw7r87Yyi2P5ffmVvjHS6lxxPzptEfvBd0AAABtSURBVAjXXclFEsIAAMDAVGlxd3fP/3/HAQodctsJANBr1yk3tVPmaGiQlhypyY/r/nI2MP96bsbErGAauKKr8ceJjmlp7c1c3bJRqwBkqqej2gyBWPUWXlUbxb4/H6oLYO+vHXCOKkWXA/+9AHuODsEpBeBlAAAAAElFTkSuQmCC"},"5015e":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPBAMAAADJ+Ih5AAAAGFBMVEVHcEwBcvEAcvIBcvEAb+8AdO4BcfABcvEnEUNlAAAAB3RSTlMAuzzLMC79DJRXcwAAADFJREFUCNdjYGBQLy9XYAACQfPyckMBIKMcBArQGOkYIlBGKQMrhFHCwIJLDW4GFAAA/zch6XBqaEgAAAAASUVORK5CYII="},"53ad":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"charge-monitor-tree_container"},[n("div",{staticClass:"left-tree"},[n("el-tree",{attrs:{data:e.treeData,props:e.treeProps,"node-key":"id",accordion:"","default-expanded-keys":e.expandData},on:{"node-expand":e.handleExpand,"node-click":e.handleNodeClick,"node-collapse":e.handleCollapse},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node,r=t.data;return n("span",{staticClass:"custom-tree-node"},["3"!==r.treeLevel?n("span",{style:e.treeNodeStyle(r)},[e._v(e._s(a.label))]):e._e(),["0","1"].includes(r.treeLevel)?[n("span",{style:e.treeNodeStyle(r)},[e._v("( "+e._s("0"===r.treeLevel?r.length:r.children.length)+" )")])]:e._e(),["2","3"].includes(r.treeLevel)?["2"===r.treeLevel?n("span",[e._v(" ( "+e._s(r.children.length)+" ) ")]):e._e(),e._l(r.devStatusList,(function(t,a){return n("span",{key:a},[n("span",{class:[e.countCircleClass(r.devStatusList[a].status),"default-circle"]},[e._v(" "+e._s(t.count)+" ")])])})),n("span",{staticClass:"span",style:e.treeNodeStyle(r)},[(e.$system.isCharging(r.status),n("span",[e._v(e._s(r.equipmentId))])),n("span",{style:e.statusIconStyle(r.status)},[n("img",{attrs:{src:e.statusIconSrc(r.status),alt:""}})])])]:e._e()],2)}}])})],1),n("div",{staticClass:"right-content"},[n("router-view",{key:e.$route.fullPath})],1)])},r=[],i=n("dc45"),s=(n("efd4"),n("a717"),n("d7f0"),n("5f2f"),n("e186"),n("a1fd")),o=n("2fae"),l=n("ed08"),d={data:function(){return{treeData:[],treeProps:{children:"children",label:"areaName"},expandData:[],intervalId:""}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getTreeData();case 2:e.defaultExpand(),e.intervalId=window.setInterval((function(){e.getTreeData()}),o["intervalTime"]),e.$baseEventBus.$on("refreshEquipmentsList",e.getTreeData());case 5:case"end":return t.stop()}}),t)})))()},destroyed:function(){window.clearInterval(this.intervalId),this.$baseEventBus.$off("refreshEquipmentsList"),this.removeStationInfo()},methods:{getTreeData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["getStationAndDeviceTree"])();case 2:n=t.sent,a=n.data,null!==a&&void 0!==a&&a.length&&(e.treeData=a.map((function(e){var t;return e.length=0,null===(t=e.children)||void 0===t||t.map((function(t){var n;null!==(n=t.children)&&void 0!==n&&n.length&&(e.length+=t.children.length)})),e})),e.currentNodeId&&(r=e.findCurrentTreeData(e.treeData,e.currentNodeId),e.setStationInfo(r)));case 5:case"end":return t.stop()}}),t)})))()},defaultExpand:function(){if("{}"===JSON.stringify(this.$route.query)){var e=Object(l["deepClone"])(this.treeData[0]);this.expandData.push(e.id);var t=Object(l["deepClone"])(e.children);if(null!==t&&void 0!==t&&t.length){var n=t[0].id,a=t[0].children;this.expandData.push(n),null!==a&&void 0!==a&&a.length&&(this.setStationInfo(a[0]),this.expandData.push(a[0].id),this.currentNodeId=a[0].id)}}else{var r=this.$route.query,i=r.areaCode,s=r.orderNo,o=r.equipmentId,d=this.findCurrentTreeData(this.treeData,i,"areaCode");this.expandData=[i],d&&this.setStationInfo(d),s&&o&&i&&this.$router.replace({name:"monitor",query:{orderNo:s,equipmentId:o,areaCode:i}})}},handleCollapse:function(e){this.expandData=[e.parentId]},handleExpand:function(e){this.expandData=[e.id]},handleNodeClick:function(e){var t=e.treeLevel;return"1"===t?(this.currentNodeId=e.children[0].id,this.setStationInfo(e.children[0]),void this.$router.push({name:"realTime"})):"2"===t?(this.currentNodeId=e.id,this.setStationInfo(e),void this.$router.push({name:"realTime"})):"3"!==t?this.$router.push({name:"realTime"}):this.$system.isCharging(e.status)?this.$system.isValidValue(e.orderNo)?(window.sessionStorage.setItem("monitorInfo",JSON.stringify(e)),void this.$router.push({name:"monitor",query:{orderNo:e.orderNo,equipmentId:e.equipmentId}})):this.$message({message:"充电数据传输延时，请稍后查看。",type:"warning"}):this.$message({message:"请查看正在充电的设备",type:"warning"})},findCurrentTreeData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",a=null,r=function e(t,r){t.forEach((function(t){t[n]===r?a=t:t.children&&t.children.length&&e(t.children,r,n)}))};return r(e,t),a},setStationInfo:function(e){window.sessionStorage.setItem("stationName",e.areaName),window.sessionStorage.setItem("equipmentsList",JSON.stringify(e.children)),this.$baseEventBus.$emit("equipmentsListChange")},removeStationInfo:function(){window.sessionStorage.removeItem("stationName"),window.sessionStorage.removeItem("equipmentsListList")},statusIconStyle:function(e){var t=this.$system.getChargingColorStyle(e);return t.marginLeft="20px",t},statusIconSrc:function(e){return this.$system.isCharging(e)?n("61bd"):this.$system.isNoCharging(e)?n("5015e"):e?n("23df"):void 0},treeNodeStyle:function(e){var t=e.treeLevel,n=e.status,a={fontWeight:"normal",color:"#333"};return"0"===t?a.color="#000":this.$system.isNoCharging(n)?a.color="#666":this.$system.isNetworkError(n)&&(a.color="#999"),a},countCircleClass:function(e){return this.$system.isCharging(e)?"charging-circle":this.$system.isNoCharging(e)?"no-charging-circle":e?"error-circle":void 0}}},c=d,u=(n("6e37"),n("cba8")),A=Object(u["a"])(c,a,r,!1,null,"02c5880f",null);t["default"]=A.exports},"61bd":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAMAAADOvxanAAAAS1BMVEVHcEyQzHSQzHWQynOQzHWQzHeQy3WQzHWQy3SQy3WQzHSQzHR/1H+W0niRzHSPzHORzXOQzHWNxnGOyXZ//3+RzHSRzHSRzHSRzHV6bh0gAAAAGHRSTlMAydk1/Dz4u8v+0uwGEY43TZEJKwLYk/K5bBv5AAAARklEQVQIHQXBBwKCQBAEsJG2h9Jt+f9LSZKMYExS1UCrCgACgIDXAwLz8YXAdg0QtOWzngie1e8DAt4dBP4/EJhmEAAEADfZAgxjQ4Dk2AAAAABJRU5ErkJggg=="},"6e37":function(e,t,n){"use strict";n("9383")},9383:function(e,t,n){},a1fd:function(e,t,n){"use strict";n.r(t),n.d(t,"getStationAndDeviceTree",(function(){return r}));var a=n("b775");function r(e){return Object(a["default"])({url:"/api/v1/apps/monitor/getStationAndDeviceTree",method:"get",data:e})}}}]);